<div class="buying">
  <app-table-controls></app-table-controls>
  <p-table [value]="buyingService.items">
    <ng-template pTemplate="header">
      <tr>
        <th
          [ngStyle]="{ width: column.width }"
          *ngFor="let column of displayedColumns"
        >
          {{ column.label }}
        </th>
      </tr>
    </ng-template>
    <ng-template pTemplate="body" let-item>
      <tr>
        <td>
          <img [src]="'http://localhost:3031/v1/' + item.icon" />
        </td>
        <td>
          {{ item.name | unescape | titlecase }}
        </td>
        <td>
          {{ item.count }}
        </td>
        <td [innerHTML]="item.buyout | toGold"></td>
        <td [innerHTML]="item.profit | toGold"></td>
        <td style="text-align: center;">{{ item.profitPct }}%</td>
        <td>
          <p-button
            (click)="onHistoryClick(item.itemId)"
            icon="pi pi-info"
            iconPos="left"
          ></p-button>
        </td>
      </tr>
    </ng-template>
  </p-table>
  <p-paginator
    class="paginator"
    [rows]="buyingService.pageSize"
    [first]="buyingService.currentPage * buyingService.pageSize"
    [totalRecords]="buyingService.totalItems"
    (onPageChange)="onPageChange($event)"
  >
  </p-paginator>
  <p-dialog
    header="History"
    [(visible)]="showInfoDialog"
    [style]="{ width: '900px', height: '500px' }"
    [draggable]="false"
    [resizable]="false"
    [dismissableMask]="true"
    [modal]="true"
  >
    <p-chart type="line" [data]="data"></p-chart>
  </p-dialog>
</div>
